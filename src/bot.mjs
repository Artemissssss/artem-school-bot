import TeleBot from "telebot"
// const openai = require('openai');
// const { MongoClient } = require('mongodb');
import { MongoClient,ObjectId } from 'mongodb';
import { nanoid } from 'nanoid'

const bot = new TeleBot( {token: process.env.TELEGRAM_BOT_TOKEN})
let lastUserMessage = {};
let userStatus = {};
let userClass = {};
let userChat = {};
let userAction = {};
bot.on('/del', async msg => {
    // const markup = updateKeyboard('apples');

    // return bot.sendMessage(
    //     msg.from.id, 'This is a editMessageReplyMarkup example. So, apples or oranges?', {markup}
    // ).then(re => {
    //     // Start updating message
    //     lastMessage = [msg.from.id, re.result.message_id];
    // });
    let replyMarkup = bot.keyboard([
        ["–ñ—É—Ä–Ω–∞–ª","–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞","–£—á–∞—Å–Ω–∏–∫–∏"],
        ["–†–æ–∑–∫–ª–∞–¥","–§–∞–π–ª–∏ —É—Ä–æ–∫—É", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —É—Ä–æ–∫—É"],
        ["–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏","C—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞—Ç–µ—Ä—ñ–∞–ª—É","–î/–∑", "–ó–∞–¥–∞—Ç–∏ –¥/–∑"],
        ["–§–∞–π–ª–∏", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª–∞","–ü–æ–¥—ñ—ó","–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–¥—ñ—ó"],
        ["–ù–∞–ø–∏—Å–∞—Ç–∏ —É—á–∞—Å–Ω–∏–∫—É","–ó—Ä–æ–±–∏—Ç–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è","–ö–ª–∞—Å–∏"]
    ], {resize: true});

    return bot.sendMessage(msg.from.id, `ü§ñ –ü—Ä–∏–≤—ñ—Ç, ${msg.from.first_name}! –Ø –≤–∞—à –æ—Å–æ–±–∏—Å—Ç–∏–π –Ω–∞–≤—á–∞–ª—å–Ω–∏–π –∞—Å–∏—Å—Ç–µ–Ω—Ç! –ó –º–æ—î—é –¥–æ–ø–æ–º–æ–≥–æ—é –≤–∏ –∑–º–æ–∂–µ—Ç–µ –ª–µ–≥–∫–æ –∫–µ—Ä—É–≤–∞—Ç–∏ –Ω–∞–≤—á–∞–ª—å–Ω–∏–º –ø—Ä–æ—Ü–µ—Å–æ–º. –û—Å—å –¥–µ—è–∫—ñ –∑ —Ñ—É–Ω–∫—Ü—ñ–π, —è–∫—ñ —è –º–æ–∂—É –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏:
    
    üè´ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –Ω–∞–≤—á–∞–ª—å–Ω–∏–º–∏ –≥—Ä—É–ø–∞–º–∏
    üìö –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∫–æ—Ä–∏—Å–Ω—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏ –≤—ñ–¥ –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤
    üìå –í–∞–∂–ª–∏–≤—ñ –∫–æ–Ω—Ç–∞–∫—Ç–∏ —Ç–∞ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è
    üìã –ó–∞–≤–¥–∞–Ω–Ω—è –≤—ñ–¥ –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤ —Ç–∞ —ó—Ö –∑–¥–∞—á–∞
    üìÅ –ü–µ—Ä–µ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ —É –≥—Ä—É–ø—ñ
    üìù –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ç–µ—Å—Ç—ñ–≤
    üóìÔ∏è –ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è –ø–æ–¥—ñ–π —Ç–∞ –∑—É—Å—Ç—Ä—ñ—á–µ–π
    üìä –û—Ü—ñ–Ω–∫–∏ —Ç–∞ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω—ñ—Å—Ç—å —É—Ä–æ–∫—ñ–≤
    üìö –ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–∞ –ø—ñ–¥—Å—É–º–∫–∏ —É—Ä–æ–∫—ñ–≤
    
    ...—Ç–∞ –±–∞–≥–∞—Ç–æ —ñ–Ω—à–æ–≥–æ! –ü—Ä–æ—Å—Ç–æ –≤–≤–µ–¥—ñ—Ç—å –∫–æ–º–∞–Ω–¥—É –∞–±–æ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É, —â–æ–± —Ä–æ–∑–ø–æ—á–∞—Ç–∏. –Ø –≥–æ—Ç–æ–≤–∏–π –¥–æ–ø–æ–º–æ–≥—Ç–∏ –≤–∞–º —É –≤—Å—å–æ–º—É, –ø–æ–≤'—è–∑–∞–Ω–æ–º—É –∑ –Ω–∞–≤—á–∞–Ω–Ω—è–º. –ü–æ—á–Ω—ñ–º–æ —Ä–∞–∑–æ–º! üéì`, {replyMarkup});
})

bot.on('/delS', async msg => {
    // const markup = updateKeyboard('apples');

    // return bot.sendMessage(
    //     msg.from.id, 'This is a editMessageReplyMarkup example. So, apples or oranges?', {markup}
    // ).then(re => {
    //     // Start updating message
    //     lastMessage = [msg.from.id, re.result.message_id];
    // });
    let replyMarkup = bot.keyboard([
        ["–©–æ–¥–µ–Ω–∏–∫","–ü–æ–¥—ñ—ó","–£—á–∞—Å–Ω–∏–∫–∏"],
        ["–†–æ–∑–∫–ª–∞–¥","–§–∞–π–ª–∏ —É—Ä–æ–∫—É", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —É—Ä–æ–∫—É"],
        ["–§–∞–π–ª–∏", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª–∞","–î/–∑", "–ó–¥–∞—Ç–∏ –¥/–∑"],
        ["–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏","C—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞—Ç–µ—Ä—ñ–∞–ª—É"],
        ["–ù–∞–ø–∏—Å–∞—Ç–∏ —É—á–∞—Å–Ω–∏–∫—É","–ö–ª–∞—Å–∏"]
    ], {resize: true});

    return bot.sendMessage(msg.from.id, `ü§ñ –ü—Ä–∏–≤—ñ—Ç, ${msg.from.first_name}! –Ø –≤–∞—à –æ—Å–æ–±–∏—Å—Ç–∏–π –Ω–∞–≤—á–∞–ª—å–Ω–∏–π –∞—Å–∏—Å—Ç–µ–Ω—Ç! –ó –º–æ—î—é –¥–æ–ø–æ–º–æ–≥–æ—é –≤–∏ –∑–º–æ–∂–µ—Ç–µ –ª–µ–≥–∫–æ –∫–µ—Ä—É–≤–∞—Ç–∏ –Ω–∞–≤—á–∞–ª—å–Ω–∏–º –ø—Ä–æ—Ü–µ—Å–æ–º. –û—Å—å –¥–µ—è–∫—ñ –∑ —Ñ—É–Ω–∫—Ü—ñ–π, —è–∫—ñ —è –º–æ–∂—É –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏:
    
    üè´ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –Ω–∞–≤—á–∞–ª—å–Ω–∏–º–∏ –≥—Ä—É–ø–∞–º–∏
    üìö –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∫–æ—Ä–∏—Å–Ω—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏ –≤—ñ–¥ –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤
    üìå –í–∞–∂–ª–∏–≤—ñ –∫–æ–Ω—Ç–∞–∫—Ç–∏ —Ç–∞ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è
    üìã –ó–∞–≤–¥–∞–Ω–Ω—è –≤—ñ–¥ –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤ —Ç–∞ —ó—Ö –∑–¥–∞—á–∞
    üìÅ –ü–µ—Ä–µ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ —É –≥—Ä—É–ø—ñ
    üìù –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ç–µ—Å—Ç—ñ–≤
    üóìÔ∏è –ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è –ø–æ–¥—ñ–π —Ç–∞ –∑—É—Å—Ç—Ä—ñ—á–µ–π
    üìä –û—Ü—ñ–Ω–∫–∏ —Ç–∞ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω—ñ—Å—Ç—å —É—Ä–æ–∫—ñ–≤
    üìö –ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–∞ –ø—ñ–¥—Å—É–º–∫–∏ —É—Ä–æ–∫—ñ–≤
    
    ...—Ç–∞ –±–∞–≥–∞—Ç–æ —ñ–Ω—à–æ–≥–æ! –ü—Ä–æ—Å—Ç–æ –≤–≤–µ–¥—ñ—Ç—å –∫–æ–º–∞–Ω–¥—É –∞–±–æ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É, —â–æ–± —Ä–æ–∑–ø–æ—á–∞—Ç–∏. –Ø –≥–æ—Ç–æ–≤–∏–π –¥–æ–ø–æ–º–æ–≥—Ç–∏ –≤–∞–º —É –≤—Å—å–æ–º—É, –ø–æ–≤'—è–∑–∞–Ω–æ–º—É –∑ –Ω–∞–≤—á–∞–Ω–Ω—è–º. –ü–æ—á–Ω—ñ–º–æ —Ä–∞–∑–æ–º! üéì`, {replyMarkup});
})


// bot.on("text", async msg =>{
//     console.log(msg)
//     await fetch("https://artem-school-bot.vercel.app/api/keyboard", {
//         method: 'POST',
//         headers: {
//             'Content-Type': 'application/json'
//         },
//         body: JSON.stringify(msg),
//     })
    
//     return null;
// })
// bot.on('text', async msg => {
// if(lastUserMessage[msg.from.username]){
//     console.log(lastUserMessage[msg.from.username])
//     lastUserMessage[msg.from.username] = msg.text;
// }else{
//     lastUserMessage[msg.from.username] = msg.text;

// }
// return null 
// })

bot.on('*', async msg => {
    console.log(msg)
    const text = msg.text
    let replyMarkup = bot.keyboard([
        ["–ñ—É—Ä–Ω–∞–ª","–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞","–£—á–∞—Å–Ω–∏–∫–∏"],
        ["–†–æ–∑–∫–ª–∞–¥","–§–∞–π–ª–∏ —É—Ä–æ–∫—É", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —É—Ä–æ–∫—É"],
        ["–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏","C—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞—Ç–µ—Ä—ñ–∞–ª—É","–î/–∑", "–ó–∞–¥–∞—Ç–∏ –¥/–∑"],
        ["–§–∞–π–ª–∏", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª–∞","–ü–æ–¥—ñ—ó","–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–¥—ñ—ó"],
        ["–ù–∞–ø–∏—Å–∞—Ç–∏ —É—á–∞—Å–Ω–∏–∫—É","–ó—Ä–æ–±–∏—Ç–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è","–ö–ª–∞—Å–∏"]
    ], {resize: true});


    
    if(text === "–°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–ª–∞—Å" && lastUserMessage[msg.from.id] === "/start" && userAction[msg.from.id] === undefined){
        let replyMarkup = bot.keyboard([
            ['–ù–∞–∑–∞–¥'],
        ], {resize: true});
        userAction[msg.from.id] = {actionReg:true}
        lastUserMessage[msg.from.id] = "–°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–ª–∞—Å";
        return  bot.sendMessage(msg.from.id, `–ù–∞–ø–∏—à—ñ—Ç—å –Ω–∞–∑–≤—É –∫–ª–∞—Å—É`, {replyMarkup});
    }else if(lastUserMessage[msg.from.id] === "–°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–ª–∞—Å" && userAction[msg.from.id].actionReg){
        let idClass = [nanoid(),nanoid()]
        const client = await MongoClient.connect(
            `mongodb+srv://${process.env.MONGO_USER}:${process.env.MONGO_PASSWORD}@${process.env.MONGO_URI}/?retryWrites=true&w=majority`,
            { useNewUrlParser: true, useUnifiedTopology: true }
        );
        const coll = client.db('artem-school').collection('classrooms');
        const result = await coll.insertOne({name:text,idT:idClass[1],idS:idClass[0],files:[],events:[],homework:[],marks:[],lessons:[],statisticks:[],materials:[]})
        const coll2 = client.db('artem-school').collection('users');
        const result2 = await coll2.insertOne({nameC: text,name:msg.from.first_name, username:msg.from.username, id:msg.from.id, role:1, classId: idClass[1]})
        await client.close();
        lastUserMessage[msg.from.id] = text;
        userStatus[msg.from.id] = 1;
        userClass[msg.from.id] = idClass[1];
        userAction[msg.from.id] = undefined;
        return bot.sendMessage(msg.from.id, `–ö–ª–∞—Å —É—Å–ø—ñ—à–Ω–æ —Å—Ç–≤–æ—Ä–∏–≤—Å—è!\n<code>${idClass[0]}</code> - id –¥–ª—è –ø—Ä–∏—î–¥–Ω–∞–Ω–Ω—è —É—á–Ω—è –≤ –∫–ª–∞—Å\n<code>${idClass[1]}</code> - id –¥–ª—è –ø—Ä–∏—î–¥–Ω–∞–Ω–Ω—è –≤—á–∏—Ç–µ–ª—è –≤ –∫–ª–∞—Å
        `, { parseMode: 'html',replyMarkup});
    }else if((lastUserMessage[msg.from.id] === "–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –≤ –∫–ª–∞—Å, —è–∫ –≤—á–∏—Ç–µ–ª—å" || lastUserMessage[msg.from.id] === "–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –≤ –∫–ª–∞—Å, —è–∫ —É—á–µ–Ω—å" || lastUserMessage[msg.from.id] === "–°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–ª–∞—Å") && text === "–ù–∞–∑–∞–¥"){
        lastUserMessage[msg.from.id] = '/start';
        userAction[msg.from.id] = undefined;
        let replyMarkup = bot.keyboard([
            ['–°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–ª–∞—Å'],
            ['–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –≤ –∫–ª–∞—Å, —è–∫ —É—á–µ–Ω—å', '–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –≤ –∫–ª–∞—Å, —è–∫ –≤—á–∏—Ç–µ–ª—å']
        ], {resize: true});
    
        return bot.sendMessage(msg.from.id, `ü§ñ –ü—Ä–∏–≤—ñ—Ç, ${msg.from.first_name}! –Ø –≤–∞—à –æ—Å–æ–±–∏—Å—Ç–∏–π –Ω–∞–≤—á–∞–ª—å–Ω–∏–π –∞—Å–∏—Å—Ç–µ–Ω—Ç! –ó –º–æ—î—é –¥–æ–ø–æ–º–æ–≥–æ—é –≤–∏ –∑–º–æ–∂–µ—Ç–µ –ª–µ–≥–∫–æ –∫–µ—Ä—É–≤–∞—Ç–∏ –Ω–∞–≤—á–∞–ª—å–Ω–∏–º –ø—Ä–æ—Ü–µ—Å–æ–º. –û—Å—å –¥–µ—è–∫—ñ –∑ —Ñ—É–Ω–∫—Ü—ñ–π, —è–∫—ñ —è –º–æ–∂—É –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏:
        
        üè´ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –Ω–∞–≤—á–∞–ª—å–Ω–∏–º–∏ –≥—Ä—É–ø–∞–º–∏
        üìö –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∫–æ—Ä–∏—Å–Ω—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏ –≤—ñ–¥ –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤
        üìå –í–∞–∂–ª–∏–≤—ñ –∫–æ–Ω—Ç–∞–∫—Ç–∏ —Ç–∞ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è
        üìã –ó–∞–≤–¥–∞–Ω–Ω—è –≤—ñ–¥ –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤ —Ç–∞ —ó—Ö –∑–¥–∞—á–∞
        üìÅ –ü–µ—Ä–µ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ —É –≥—Ä—É–ø—ñ
        üìù –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ç–µ—Å—Ç—ñ–≤
        üóìÔ∏è –ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è –ø–æ–¥—ñ–π —Ç–∞ –∑—É—Å—Ç—Ä—ñ—á–µ–π
        üìä –û—Ü—ñ–Ω–∫–∏ —Ç–∞ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω—ñ—Å—Ç—å —É—Ä–æ–∫—ñ–≤
        üìö –ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–∞ –ø—ñ–¥—Å—É–º–∫–∏ —É—Ä–æ–∫—ñ–≤
        
        ...—Ç–∞ –±–∞–≥–∞—Ç–æ —ñ–Ω—à–æ–≥–æ! –ü—Ä–æ—Å—Ç–æ –≤–≤–µ–¥—ñ—Ç—å –∫–æ–º–∞–Ω–¥—É –∞–±–æ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É, —â–æ–± —Ä–æ–∑–ø–æ—á–∞—Ç–∏. –Ø –≥–æ—Ç–æ–≤–∏–π –¥–æ–ø–æ–º–æ–≥—Ç–∏ –≤–∞–º —É –≤—Å—å–æ–º—É, –ø–æ–≤'—è–∑–∞–Ω–æ–º—É –∑ –Ω–∞–≤—á–∞–Ω–Ω—è–º. –ü–æ—á–Ω—ñ–º–æ —Ä–∞–∑–æ–º! üéì`, {replyMarkup});
    }else if(text === "–ù–∞–∑–∞–¥"){
        lastUserMessage[msg.from.id] = 'someText';
        userAction[msg.from.id] = undefined;
        if(userStatus[msg.from.id]){
            return  bot.sendMessage(msg.from.id, `–í–∏ –ø–æ–≤–µ—Ä–Ω—É–ª–∏—Å—è –≤ –≥–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é`, {replyMarkup});
        }else if(userStatus[msg.from.id] === 0){
            let replyMarkup = bot.keyboard([
                ["–©–æ–¥–µ–Ω–∏–∫","–ü–æ–¥—ñ—ó","–£—á–∞—Å–Ω–∏–∫–∏"],
                ["–†–æ–∑–∫–ª–∞–¥","–§–∞–π–ª–∏ —É—Ä–æ–∫—É", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —É—Ä–æ–∫—É"],
                ["–§–∞–π–ª–∏", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª–∞","–î/–∑", "–ó–¥–∞—Ç–∏ –¥/–∑"],
                ["–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏","C—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞—Ç–µ—Ä—ñ–∞–ª—É"],
                ["–ù–∞–ø–∏—Å–∞—Ç–∏ —É—á–∞—Å–Ω–∏–∫—É","–ö–ª–∞—Å–∏"]
            ], {resize: true});
            return  bot.sendMessage(msg.from.id, `–í–∏ –ø–æ–≤–µ—Ä–Ω—É–ª–∏—Å—è –≤ –≥–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é`, {replyMarkup});
        }
    }else if(text === "–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –≤ –∫–ª–∞—Å, —è–∫ —É—á–µ–Ω—å" && lastUserMessage[msg.from.id] === "/start"){
        let replyMarkup = bot.keyboard([
            ["–ù–∞–∑–∞–¥"],
        ], {resize: true});
        lastUserMessage[msg.from.id] = text;
        return  bot.sendMessage(msg.from.id, `–ù–∞–¥—ñ—à–ª—ñ—Ç—å id —É—á–Ω—è`, {replyMarkup});
    }else if(lastUserMessage[msg.from.id] === "–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –≤ –∫–ª–∞—Å, —è–∫ —É—á–µ–Ω—å"){
        let replyMarkup = bot.keyboard([
            ["–©–æ–¥–µ–Ω–∏–∫","–ü–æ–¥—ñ—ó","–£—á–∞—Å–Ω–∏–∫–∏"],
            ["–†–æ–∑–∫–ª–∞–¥","–§–∞–π–ª–∏ —É—Ä–æ–∫—É", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —É—Ä–æ–∫—É"],
            ["–§–∞–π–ª–∏", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª–∞","–î/–∑", "–ó–¥–∞—Ç–∏ –¥/–∑"],
            ["–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏","C—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞—Ç–µ—Ä—ñ–∞–ª—É"],
            ["–ù–∞–ø–∏—Å–∞—Ç–∏ —É—á–∞—Å–Ω–∏–∫—É","–ö–ª–∞—Å–∏"]
        ], {resize: true});
        const client = await MongoClient.connect(
            `mongodb+srv://${process.env.MONGO_USER}:${process.env.MONGO_PASSWORD}@${process.env.MONGO_URI}/?retryWrites=true&w=majority`,
            { useNewUrlParser: true, useUnifiedTopology: true }
        );
        const coll = client.db('artem-school').collection('classrooms');
                const filter = {idS: msg.text};
                const cursor = coll.find(filter);
                const result = await cursor.toArray();
                console.log(result)
                if(result[0]){
                    const coll2 = client.db('artem-school').collection('users');
                    const result2 = await coll2.insertOne({nameC: result[0].name, name:msg.from.first_name, username:msg.from.username, id:msg.from.id, role:0, classId: result[0].idS})
                     await client.close();
                     lastUserMessage[msg.from.id] = text;
                     userStatus[msg.from.id] = 0;
                     userClass[msg.from.id] = result[0].idS;
                     return await bot.sendMessage(msg.from.id, `–í–∏ —É—Å–ø—ñ—à–Ω–æ –¥–æ—î–¥–Ω–∞–ª–∏—Å—è –¥–æ –∫–ª–∞—Å—É`, {replyMarkup});
                }else{
                    await client.close();
                    return await bot.sendMessage(msg.from.id, `–í–∏ –≤–µ–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π id –∫–ª–∞—Å—É`);
                }  
    }else if(text === "–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –≤ –∫–ª–∞—Å, —è–∫ –≤—á–∏—Ç–µ–ª—å" && lastUserMessage[msg.from.id] === "/start"){
        let replyMarkup = bot.keyboard([
            ["–ù–∞–∑–∞–¥"],
        ], {resize: true});
        lastUserMessage[msg.from.id] = text;
        return  bot.sendMessage(msg.from.id, `–ù–∞–¥—ñ—à–ª—ñ—Ç—å id –≤—á–∏—Ç–µ–ª—è `, {replyMarkup});
    }else if(lastUserMessage[msg.from.id] === "–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –≤ –∫–ª–∞—Å, —è–∫ –≤—á–∏—Ç–µ–ª—å"){
        const client = await MongoClient.connect(
            `mongodb+srv://${process.env.MONGO_USER}:${process.env.MONGO_PASSWORD}@${process.env.MONGO_URI}/?retryWrites=true&w=majority`,
            { useNewUrlParser: true, useUnifiedTopology: true }
        );
        const coll = client.db('artem-school').collection('classrooms');
                const filter = {idT: msg.text};
                const cursor = coll.find(filter);
                const result = await cursor.toArray();
                if(result[0]){
                    const coll2 = client.db('artem-school').collection('users');
                    const result2 = await coll2.insertOne({nameC: result[0].name,name:msg.from.first_name, username:msg.from.username, id:msg.from.id, role:1, classId: result[0].idT})
                     await client.close();
                     lastUserMessage[msg.from.id] = text;
                     userStatus[msg.from.id] = 1;
                     userClass[msg.from.id] = result[0].idT;
                     return await bot.sendMessage(msg.from.id, `–í–∏ —É—Å–ø—ñ—à–Ω–æ –¥–æ—î–¥–Ω–∞–ª–∏—Å—è –¥–æ –∫–ª–∞—Å—É`, {replyMarkup});
                }else{
                    await client.close();
                    return await bot.sendMessage(msg.from.id, `–í–∏ –≤–µ–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π id –∫–ª–∞—Å—É`);
                } 
    }else if(lastUserMessage[msg.from.id] === "/start" && text !== "–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –≤ –∫–ª–∞—Å, —è–∫ –≤—á–∏—Ç–µ–ª—å" && text !== "–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –≤ –∫–ª–∞—Å, —è–∫ —É—á–µ–Ω—å" && text !== "–°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–ª–∞—Å"){
        let replyMarkup = bot.keyboard([
            ['–°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–ª–∞—Å'],
            ['–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –≤ –∫–ª–∞—Å, —è–∫ —É—á–µ–Ω—å', '–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –≤ –∫–ª–∞—Å, —è–∫ –≤—á–∏—Ç–µ–ª—å']
        ], {resize: true});
        return bot.sendMessage(msg.from.id, `Error`, {replyMarkup});
    }

    if(userStatus[msg.from.id] === undefined && text !== "/start"){
        const client = await MongoClient.connect(
            `mongodb+srv://${process.env.MONGO_USER}:${process.env.MONGO_PASSWORD}@${process.env.MONGO_URI}/?retryWrites=true&w=majority`,
            { useNewUrlParser: true, useUnifiedTopology: true }
        );
        const coll = client.db('artem-school').collection('users');
        const filter = {id: msg.from.id};
        const cursor = coll.find(filter);
        const result = await cursor.toArray();

        await client.close();
        if(result[0]){
            if(result.length === 1){
                userStatus[msg.from.id] = result[0].role;
                userClass[msg.from.id] = result[0].classId;
            }else{
                let arrBtn = () => {
                    let arr = [];
                    userAction[msg.from.id] =[{act:true}];
                    for(let i = 0; i< result.length;i++){
                        let joinId =nanoid()
                        userAction[msg.from.id] = [{name:result[i].nameC,id:result[i].classId, role:result[i].role, joinId:joinId},...userAction[msg.from.id]]
                        arr = [[bot.inlineButton(`${result[i].nameC}`, {callback: joinId})],...arr]
                    };
                    return arr;
                };
                let replyMarkup = bot.inlineKeyboard(arrBtn());

                return bot.sendMessage(msg.chat.id,`–í–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –¥–µ–∫—ñ–ª—å–∫–æ—Ö –∫–ª–∞—Å–∞—Ö, —Ç–æ–º—É –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É –∑–Ω–∏–∑—É –≤ —è–∫–æ–º—É –≤–∏ —Ö–æ—á–µ—Ç–µ –∑–∞—Ä–∞–∑ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏:`, {replyMarkup});
            }
        }else{
            return bot.sendMessage(msg.from.id, "–ù–µ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∏–π –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å /start")
        }
    }
//.filter((arr) => arr.id === msg.from.id)
if(userStatus[msg.from.id] !== undefined){
    if(text === "–ö–ª–∞—Å–∏"){
        const client = await MongoClient.connect(
            `mongodb+srv://${process.env.MONGO_USER}:${process.env.MONGO_PASSWORD}@${process.env.MONGO_URI}/?retryWrites=true&w=majority`,
            { useNewUrlParser: true, useUnifiedTopology: true }
        );
        const coll = client.db('artem-school').collection('users');
        const filter = {id: msg.from.id};
        const cursor = coll.find(filter);
        const result = await cursor.toArray();

        await client.close();
        if(result[0]){
            if(result.length === 1){
                return bot.sendMessage(msg.chat.id,`–í–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—è —Ç—ñ–ª—å–∫–∏ –≤ –æ–¥–Ω–æ–º—É –∫–ª–∞—Å—ñ`);
            }else{
                let arrBtn = () => {
                    let arr = [];
                    userAction[msg.from.id] =[{act:true}];
                    for(let i = 0; i< result.length;i++){
                        let joinId =nanoid()
                        userAction[msg.from.id] = [{name:result[i].nameC,id:result[i].classId, role:result[i].role, joinId:joinId},...userAction[msg.from.id]]
                        arr = [[bot.inlineButton(`${result[i].nameC}`, {callback: joinId})],...arr]
                    };
                    return arr;
                };
                let replyMarkup = bot.inlineKeyboard(arrBtn());

                return bot.sendMessage(msg.chat.id,`–í–∏ –∑–Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –¥–µ–∫—ñ–ª—å–∫–æ—Ö –∫–ª–∞—Å–∞—Ö, —Ç–æ–º—É –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É –∑–Ω–∏–∑—É –≤ —è–∫–æ–º—É –≤–∏ —Ö–æ—á–µ—Ç–µ –∑–∞—Ä–∞–∑ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏:`, {replyMarkup});
            }
            console.log(userClass[msg.from.id],userStatus[msg.from.id])
        }
    }


    if(text === "–§–∞–π–ª–∏" && userAction[msg.from.id] === undefined){
        // let replyMarkup = bot.inlineKeyboard([
        //     [
        //         bot.inlineButton('–ó–∞–≥—Ä—É–∑–∏—Ç–∏ —Ñ–∞–π–ª', {callback: "–ó–∞–≥—Ä—É–∑–∏—Ç–∏ —Ñ–∞–π–ª"}),
        //     ], [
        //         bot.inlineButton('–û—Ç—Ä–∏–º–∞—Ç–∏ —Ñ–∞–π–ª–∏', {callback: "–û—Ç—Ä–∏–º–∞—Ç–∏ —Ñ–∞–π–ª–∏"})
        //     ]
        // ]);
        const client = await MongoClient.connect(
            `mongodb+srv://${process.env.MONGO_USER}:${process.env.MONGO_PASSWORD}@${process.env.MONGO_URI}/?retryWrites=true&w=majority`,
            { useNewUrlParser: true, useUnifiedTopology: true }
        );
        // const coll = client.db('artem-school').collection('users');
        // const filter = {id: msg.from.id};
        // const cursor = coll.find(filter);
        // const result = await cursor.toArray();

        const coll1 = client.db('artem-school').collection('classrooms');
        const filter1 = userStatus[msg.from.id]  ?  {idT: userClass[msg.from.id]} : {idS: userClass[msg.from.id]};
        const cursor1 = coll1.find(filter1);
        const result1 = await cursor1.toArray();
        await client.close();
        console.log(userStatus[msg.from.id]  ?  {idT: userClass[msg.from.id]} : {idS: userClass[msg.from.id]})
        if(result1[0]){
            if(result1[0].files.length===0){
                return bot.sendMessage(msg.chat.id, '–í —Ü—å–æ–º—É –∫–ª–∞—Å—ñ —â–µ –Ω–µ–º–∞—î —Ñ–∞–π–ª—ñ–≤');
            }else{
                for(let i = 0; i<result1[0].files.length;i++){
                    await bot.forwardMessage(msg.chat.id,result1[0].files[i].chatID,result1[0].files[i].msgID);
                    if(msg.chat.type ==="private" && userStatus[msg.from.id]){
                        await bot.sendMessage(msg.chat.id,`${result1[0].files[i].chatID}&&${result1[0].files[i].msgID}`);
                    }
                }
                return bot.sendMessage(msg.chat.id, '–¶–µ –≤—Å—ñ —Ñ–∞–π–ª–∏ –≤ —Ü—å–æ–º—É –∫–ª–∞—Å—ñ');
            }
        }else{
            return bot.sendMessage(msg.chat.id, 'Error');
        }
    }else if(text === "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª–∞" && userAction[msg.from.id] === undefined){
        let replyMarkup = bot.keyboard([
            ["–ù–∞–∑–∞–¥"],
        ], {resize: true});

        lastUserMessage[msg.from.id] = text;
        return bot.sendMessage(msg.chat.id, '–ù–∞–¥—ñ—à–ª—ñ—Ç—å —Ñ–∞–π–ª',{replyMarkup});
    }else if(lastUserMessage[msg.from.id] === "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª–∞" && msg.text === undefined){
        console.log(lastUserMessage[msg.from.id])
        const client = await MongoClient.connect(
            `mongodb+srv://${process.env.MONGO_USER}:${process.env.MONGO_PASSWORD}@${process.env.MONGO_URI}/?retryWrites=true&w=majority`,
            { useNewUrlParser: true, useUnifiedTopology: true }
        );
        // const coll = client.db('artem-school').collection('users');
        // const filter = {id: msg.from.id};
        // const cursor = coll.find(filter);
        // const result = await cursor.toArray();


        const coll1 = client.db('artem-school').collection('classrooms');
        const filter1 = userStatus[msg.from.id]  ?  {idT: userClass[msg.from.id]} : {idS: userClass[msg.from.id]};
        const cursor1 = coll1.find(filter1);
        const result1 = await cursor1.toArray();
                const files = {files : [...result1[0].files, {chatID:msg.chat.id, msgID:msg.message_id}]}
                console.log(result1)
                await coll1.updateOne(
                    {_id: new ObjectId(result1[0]._id)},
                    {
                      $set: { ...files},
                      $currentDate: { lastModified: true }
                    }
                 )
                await client.close();
                lastUserMessage[msg.from.id] = "text–§–∞–π–ª";
                if(userStatus[msg.from.id]){
                    return await bot.sendMessage(msg.chat.id, '–§–∞–π–ª –¥–æ–¥–∞–Ω–æ', {replyMarkup});
                }else if(userStatus[msg.from.id] === 0){
                    let replyMarkup = bot.keyboard([
                        ["–©–æ–¥–µ–Ω–∏–∫","–ü–æ–¥—ñ—ó","–£—á–∞—Å–Ω–∏–∫–∏"],
                        ["–†–æ–∑–∫–ª–∞–¥","–§–∞–π–ª–∏ —É—Ä–æ–∫—É", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —É—Ä–æ–∫—É"],
                        ["–§–∞–π–ª–∏", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª–∞","–î/–∑", "–ó–¥–∞—Ç–∏ –¥/–∑"],
                        ["–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏","C—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞—Ç–µ—Ä—ñ–∞–ª—É"],
                        ["–ù–∞–ø–∏—Å–∞—Ç–∏ —É—á–∞—Å–Ω–∏–∫—É","–ö–ª–∞—Å–∏"]
                    ], {resize: true});
                    return await bot.sendMessage(msg.chat.id, '–§–∞–π–ª –¥–æ–¥–∞–Ω–æ', {replyMarkup});
                }
        return await bot.sendMessage(msg.chat.id, '–§–∞–π–ª –¥–æ–¥–∞–Ω–æ');
    }

    if(text === "–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏" && userAction[msg.from.id] === undefined){
        // let replyMarkup = bot.inlineKeyboard([
        //     [
        //         bot.inlineButton('–ó–∞–≥—Ä—É–∑–∏—Ç–∏ —Ñ–∞–π–ª', {callback: "–ó–∞–≥—Ä—É–∑–∏—Ç–∏ —Ñ–∞–π–ª"}),
        //     ], [
        //         bot.inlineButton('–û—Ç—Ä–∏–º–∞—Ç–∏ —Ñ–∞–π–ª–∏', {callback: "–û—Ç—Ä–∏–º–∞—Ç–∏ —Ñ–∞–π–ª–∏"})
        //     ]
        // ]);
        const client = await MongoClient.connect(
            `mongodb+srv://${process.env.MONGO_USER}:${process.env.MONGO_PASSWORD}@${process.env.MONGO_URI}/?retryWrites=true&w=majority`,
            { useNewUrlParser: true, useUnifiedTopology: true }
        );
        // const coll = client.db('artem-school').collection('users');
        // const filter = {id: msg.from.id};
        // const cursor = coll.find(filter);
        // const result = await cursor.toArray();

        const coll1 = client.db('artem-school').collection('classrooms');
        const filter1 = userStatus[msg.from.id]  ?  {idT: userClass[msg.from.id]} : {idS: userClass[msg.from.id]};
        const cursor1 = coll1.find(filter1);
        const result1 = await cursor1.toArray();
        await client.close();
        console.log(userStatus[msg.from.id]  ?  {idT: userClass[msg.from.id]} : {idS: userClass[msg.from.id]})
        if(result1[0]){
            if(result1[0].materials.length===0){
                return bot.sendMessage(msg.chat.id, '–í —Ü—å–æ–º—É –∫–ª–∞—Å—ñ —â–µ –Ω–µ–º–∞—î —Ñ–∞–π–ª—ñ–≤');
            }else{
                for(let i = 0; i<result1[0].materials.length;i++){
                    await bot.forwardMessage(msg.chat.id,result1[0].materials[i].chatID,result1[0].materials[i].msgID);
                    if(msg.chat.type ==="private" && userStatus[msg.from.id]){
                        await bot.sendMessage(msg.chat.id,`${result1[0].materials[i].chatID}&&${result1[0].materials[i].msgID}`);
                    }
                }
                return bot.sendMessage(msg.chat.id, '–¶–µ –≤—Å—ñ —Ñ–∞–π–ª–∏ –≤ —Ü—å–æ–º—É –∫–ª–∞—Å—ñ');
            }
        }else{
            return bot.sendMessage(msg.chat.id, 'Error');
        }
    }

    if(text === "–ü–æ–¥—ñ—ó" && userAction[msg.from.id] === undefined){
        // let replyMarkup = bot.inlineKeyboard([
        //     [
        //         bot.inlineButton('–ó–∞–≥—Ä—É–∑–∏—Ç–∏ —Ñ–∞–π–ª', {callback: "–ó–∞–≥—Ä—É–∑–∏—Ç–∏ —Ñ–∞–π–ª"}),
        //     ], [
        //         bot.inlineButton('–û—Ç—Ä–∏–º–∞—Ç–∏ —Ñ–∞–π–ª–∏', {callback: "–û—Ç—Ä–∏–º–∞—Ç–∏ —Ñ–∞–π–ª–∏"})
        //     ]
        // ]);
        const client = await MongoClient.connect(
            `mongodb+srv://${process.env.MONGO_USER}:${process.env.MONGO_PASSWORD}@${process.env.MONGO_URI}/?retryWrites=true&w=majority`,
            { useNewUrlParser: true, useUnifiedTopology: true }
        );
        // const coll = client.db('artem-school').collection('users');
        // const filter = {id: msg.from.id};
        // const cursor = coll.find(filter);
        // const result = await cursor.toArray();

        const coll1 = client.db('artem-school').collection('classrooms');
        const filter1 = userStatus[msg.from.id]  ?  {idT: userClass[msg.from.id]} : {idS: userClass[msg.from.id]}
        const cursor1 = coll1.find(filter1);
        const result1 = await cursor1.toArray();
        await client.close();
        if(result1[0]){
            if(result1[0].events.length===0){
                return bot.sendMessage(msg.chat.id, '–í —Ü—å–æ–º—É –∫–ª–∞—Å—ñ —â–µ –Ω–µ–º–∞—î –ø–æ–¥—ñ–π');
            }else{
                console.log(result1[0].events)
                for(let i = 0; i<result1[0].events.length;i++){
                    await bot.sendMessage(msg.chat.id, `${result1[0].events[i].text}\n\n\n–û ${result1[0].events[i].date} ${result1[0].events[i].time}\n\n–î–ª—è: ${result1[0].events[i].who}`);
                    if(msg.chat.type ==="private" && userStatus[msg.from.id]){
                        await bot.sendMessage(msg.from.id, `${result1[0].events[i].id}`);
                    }
                }
                return bot.sendMessage(msg.chat.id, '–¶–µ –≤—Å—ñ –ø–æ–¥—ñ—ó –≤ —Ü—å–æ–º—É –∫–ª–∞—Å—ñ');
            }
        }else{
            return bot.sendMessage(msg.chat.id, 'Error');
        }
    }

}

if(userStatus[msg.from.id]){
    console.log(userAction[msg.from.id])
    if(text ==="–ó—Ä–æ–±–∏—Ç–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è"){
        let replyMarkup = bot.keyboard([
            ["–ù–∞–∑–∞–¥"],
        ], {resize: true});
        lastUserMessage[msg.from.id] = "–ó—Ä–æ–±–∏—Ç–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è";
        return bot.sendMessage(msg.chat.id, `–ù–∞–¥—ñ—à–ª—ñ—Ç—å —Ç–µ–∫—Å—Ç –¥–ª—è –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è/n(–æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –±—É–¥–µ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –∑—Ä–∞–∑—É –ø—ñ—Å–ª—è –Ω–∞—Å–∏–ª–∞–Ω–Ω—è —Ç–µ–∫—Å—Ç—É)`, {replyMarkup});
    }else if(lastUserMessage[msg.from.id] === "–ó—Ä–æ–±–∏—Ç–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è"){
        const client = await MongoClient.connect(
            `mongodb+srv://${process.env.MONGO_USER}:${process.env.MONGO_PASSWORD}@${process.env.MONGO_URI}/?retryWrites=true&w=majority`,
            { useNewUrlParser: true, useUnifiedTopology: true }
        );
        const coll1 = client.db('artem-school').collection('classrooms');
        const filter1 = userStatus[msg.from.id]  ?  {idT: userClass[msg.from.id]} : {idS: userClass[msg.from.id]}
        const cursor1 = coll1.find(filter1);
        const result1 = await cursor1.toArray();

        const coll = client.db('artem-school').collection('users');
        const filter = {classId: result1[0].idS};
        const filter2 = {classId: result1[0].idT};
        const cursor = coll.find(filter);
        const cursor2 = coll.find(filter2);
        const result = await cursor.toArray();
        const result2 = await cursor2.toArray();
        await client.close();

        for(let i = 0; i<result.length;i++){
            await bot.sendMessage(result[i].id, `–£ –≤–∞—Å –Ω–æ–≤–µ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –≤—ñ–¥ ${msg.from.first_name}:\n${text}`);
        }

        for(let i = 0; i<result2.length;i++){
            console.log(result2[i])
            if(result2[i].id !== msg.from.id){
                await bot.sendMessage(result2[i].id, `–£ –≤–∞—Å –Ω–æ–≤–µ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –≤—ñ–¥ ${msg.from.first_name}:\n${text}`);
            }
        }

        if(userStatus[msg.from.id]){
            return  await bot.sendMessage(msg.from.id, `–í–∏ –ø–æ–≤–µ—Ä–Ω—É–ª–∏—Å—è –≤ –≥–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é`, {replyMarkup});
        }else if(userStatus[msg.from.id] === 0){
            let replyMarkup = bot.keyboard([
                ["–©–æ–¥–µ–Ω–∏–∫","–ü–æ–¥—ñ—ó","–£—á–∞—Å–Ω–∏–∫–∏"],
                ["–†–æ–∑–∫–ª–∞–¥","–§–∞–π–ª–∏ —É—Ä–æ–∫—É", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —É—Ä–æ–∫—É"],
                ["–§–∞–π–ª–∏", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª–∞","–î/–∑", "–ó–¥–∞—Ç–∏ –¥/–∑"],
                ["–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏","C—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞—Ç–µ—Ä—ñ–∞–ª—É"],
                ["–ù–∞–ø–∏—Å–∞—Ç–∏ —É—á–∞—Å–Ω–∏–∫—É","–ö–ª–∞—Å–∏"]
            ], {resize: true});
            return  await bot.sendMessage(msg.from.id, `–í–∏ –ø–æ–≤–µ—Ä–Ω—É–ª–∏—Å—è –≤ –≥–æ–ª–æ–≤–Ω–µ –º–µ–Ω—é`, {replyMarkup});
        }
    }
    if(text === "–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–¥—ñ—ó" && userAction[msg.from.id] === undefined){
        let replyMarkup = bot.keyboard([
            ["–ù–∞–∑–∞–¥"],
        ], {resize: true});
        lastUserMessage[msg.from.id] = text;
        userAction[msg.from.id] = {id:nanoid(),text:"",date:"", time:"",who:""}
        return bot.sendMessage(msg.chat.id, '–ù–∞–¥—ñ—à–ª—ñ—Ç—å —Ç–µ–∫—Å—Ç –ø–æ–¥—ñ—ó',{replyMarkup});
    }else if(lastUserMessage[msg.from.id] === "–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–¥—ñ—ó" && lastUserMessage[msg.from.id] === "–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–¥—ñ—ó" && !userAction[msg.from.id].text && !userAction[msg.from.id].date && !userAction[msg.from.id].time && !userAction[msg.from.id].who){
        userAction[msg.from.id] = {id:nanoid(),text:text,date:"", time:"",who:""}
        return bot.sendMessage(msg.chat.id, '–ù–∞–¥—ñ—à–ª—ñ—Ç—å –¥–∞—Ç—É –ø–æ–¥—ñ—ó —É —Ñ–æ—Ä–º–∞—Ç—ñ –¥–¥.–º–º.—Ä—Ä—Ä—Ä');
    }else if(lastUserMessage[msg.from.id] === "–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–¥—ñ—ó" && userAction[msg.from.id].text && !userAction[msg.from.id].date && !userAction[msg.from.id].time && !userAction[msg.from.id].who){
        userAction[msg.from.id] = {...userAction[msg.from.id], date:text};
        console.log(userAction[msg.from.id])
        return bot.sendMessage(msg.chat.id, '–ù–∞–¥—ñ—à–ª—ñ—Ç—å —á–∞—Å –ø–æ–¥—ñ—ó —É —Ñ–æ—Ä–º–∞—Ç—ñ –≥–≥:—Ö—Ö');
    }else if(lastUserMessage[msg.from.id] === "–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–¥—ñ—ó" && userAction[msg.from.id].text && userAction[msg.from.id].date && !userAction[msg.from.id].time && !userAction[msg.from.id].who){
        userAction[msg.from.id] = {...userAction[msg.from.id], time:text};
        return bot.sendMessage(msg.chat.id, '–ù–∞–¥—ñ—à–ª—ñ—Ç—å –¥–ª—è –∫–æ–≥–æ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∞ —Ü—è –ø–æ–¥—ñ—è —É –¥–æ–≤—ñ–ª—å–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ');
    }else if(lastUserMessage[msg.from.id] === "–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–¥—ñ—ó" && userAction[msg.from.id].text && userAction[msg.from.id].date && userAction[msg.from.id].time && !userAction[msg.from.id].who){
        userAction[msg.from.id] = {...userAction[msg.from.id],who:text};
        
        console.log(lastUserMessage[msg.from.id])
        const client = await MongoClient.connect(
            `mongodb+srv://${process.env.MONGO_USER}:${process.env.MONGO_PASSWORD}@${process.env.MONGO_URI}/?retryWrites=true&w=majority`,
            { useNewUrlParser: true, useUnifiedTopology: true }
        );
        // const coll = client.db('artem-school').collection('users');
        // const filter = {id: msg.from.id};
        // const cursor = coll.find(filter);
        // const result = await cursor.toArray();


        const coll1 = client.db('artem-school').collection('classrooms');
        const filter1 = userStatus[msg.from.id]  ?  {idT: userClass[msg.from.id]} : {idS: userClass[msg.from.id]};
        const cursor1 = coll1.find(filter1);
        const result1 = await cursor1.toArray();
                const events = {events : [...result1[0].events, userAction[msg.from.id]]}
                console.log(result1)
                await coll1.updateOne(
                    {_id: new ObjectId(result1[0]._id)},
                    {
                      $set: { ...events},
                      $currentDate: { lastModified: true }
                    }
                 )
                await client.close();
                lastUserMessage[msg.from.id] = "text–§–∞–π–ª";
                userAction[msg.from.id] = undefined;
                if(userStatus[msg.from.id]){
                    return await bot.sendMessage(msg.chat.id, '–ü–æ–¥—ñ—è –¥–æ–¥–∞–Ω–∞',{replyMarkup});
                }else if(userStatus[msg.from.id] === 0){
                    let replyMarkup = bot.keyboard([
                        ["–©–æ–¥–µ–Ω–∏–∫","–ü–æ–¥—ñ—ó","–£—á–∞—Å–Ω–∏–∫–∏"],
                        ["–†–æ–∑–∫–ª–∞–¥","–§–∞–π–ª–∏ —É—Ä–æ–∫—É", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —É—Ä–æ–∫—É"],
                        ["–§–∞–π–ª–∏", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª–∞","–î/–∑", "–ó–¥–∞—Ç–∏ –¥/–∑"],
                        ["–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏","C—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞—Ç–µ—Ä—ñ–∞–ª—É"],
                        ["–ù–∞–ø–∏—Å–∞—Ç–∏ —É—á–∞—Å–Ω–∏–∫—É","–ö–ª–∞—Å–∏"]
                    ], {resize: true});
                    return await bot.sendMessage(msg.chat.id, '–ü–æ–¥—ñ—è –¥–æ–¥–∞–Ω–∞',{replyMarkup});
                }
    }

    if(text === "C—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞—Ç–µ—Ä—ñ–∞–ª—É" && userAction[msg.from.id] === undefined){
        let replyMarkup = bot.keyboard([
            ["–ù–∞–∑–∞–¥"],
        ], {resize: true});

        lastUserMessage[msg.from.id] = text;
        return bot.sendMessage(msg.chat.id, '–ù–∞–¥—ñ—à–ª—ñ—Ç—å –º–∞—Ç–µ—Ä—ñ–∞–ª —Ç–µ–∫—Å—Ç/–∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è/–ø–æ—Å–∏–ª–∞–Ω–Ω—è/—Ñ–∞–π–ª',{replyMarkup});
    }else if(lastUserMessage[msg.from.id] === "C—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞—Ç–µ—Ä—ñ–∞–ª—É"){
        console.log(lastUserMessage[msg.from.id])
        const client = await MongoClient.connect(
            `mongodb+srv://${process.env.MONGO_USER}:${process.env.MONGO_PASSWORD}@${process.env.MONGO_URI}/?retryWrites=true&w=majority`,
            { useNewUrlParser: true, useUnifiedTopology: true }
        );
        // const coll = client.db('artem-school').collection('users');
        // const filter = {id: msg.from.id};
        // const cursor = coll.find(filter);
        // const result = await cursor.toArray();


        const coll1 = client.db('artem-school').collection('classrooms');
        const filter1 = userStatus[msg.from.id]  ?  {idT: userClass[msg.from.id]} : {idS: userClass[msg.from.id]};
        const cursor1 = coll1.find(filter1);
        const result1 = await cursor1.toArray();
                const materials = {materials : [...result1[0].materials, {chatID:msg.chat.id, msgID:msg.message_id}]}
                console.log(result1)
                await coll1.updateOne(
                    {_id: new ObjectId(result1[0]._id)},
                    {
                      $set: { ...materials},
                      $currentDate: { lastModified: true }
                    }
                 )
                await client.close();
                lastUserMessage[msg.from.id] = "text–§–∞–π–ª";
                if(userStatus[msg.from.id]){
                    return await bot.sendMessage(msg.chat.id, '–ú–∞—Ç–µ—Ä—ñ–∞–ª –¥–æ–¥–∞–Ω–æ', {replyMarkup});
                }
    }

if (text === "–í–∏–¥–∞–ª–∏—Ç–∏" && msg.reply_to_message !== undefined && userAction[msg.from.id] === undefined && msg.reply_to_message.text.includes("&&")){
    const client = await MongoClient.connect(
        `mongodb+srv://${process.env.MONGO_USER}:${process.env.MONGO_PASSWORD}@${process.env.MONGO_URI}/?retryWrites=true&w=majority`,
        { useNewUrlParser: true, useUnifiedTopology: true }
    );
    // const coll = client.db('artem-school').collection('users');
    // const filter = {id: msg.from.id};
    // const cursor = coll.find(filter);
    // const result = await cursor.toArray();
    

    const coll1 = client.db('artem-school').collection('classrooms');
    const filter1 = userStatus[msg.from.id]  ?  {idT: userClass[msg.from.id]} : {idS: userClass[msg.from.id]};
    const cursor1 = coll1.find(filter1);
    const result1 = await cursor1.toArray();
    console.log(msg.reply_to_message.text)
            const files = {files : [...result1[0].files.filter((arr) => arr.chatID !== parseInt(msg.reply_to_message.text.split("&&")[0]) && arr.msgID !== parseInt(msg.reply_to_message.text.split("&&")[1]))]}
            console.log(files)
            await coll1.updateOne(
                {_id: new ObjectId(result1[0]._id)},
                {
                  $set: { ...files},
                  $currentDate: { lastModified: true }
                }
             )
            await client.close();
            lastUserMessage[msg.from.id] = "text–§–∞–π–ª";
    return await bot.sendMessage(msg.chat.id, '–§–∞–π–ª –≤–∏–¥–∞–ª–µ–Ω–æ');
}else if (text === "–í–∏–¥–∞–ª–∏—Ç–∏" && msg.reply_to_message !== undefined && userAction[msg.from.id] === undefined){
    const client = await MongoClient.connect(
        `mongodb+srv://${process.env.MONGO_USER}:${process.env.MONGO_PASSWORD}@${process.env.MONGO_URI}/?retryWrites=true&w=majority`,
        { useNewUrlParser: true, useUnifiedTopology: true }
    );
    // const coll = client.db('artem-school').collection('users');
    // const filter = {id: msg.from.id};
    // const cursor = coll.find(filter);
    // const result = await cursor.toArray();
    

    const coll1 = client.db('artem-school').collection('classrooms');
    const filter1 = userStatus[msg.from.id]  ?  {idT: userClass[msg.from.id]} : {idS: userClass[msg.from.id]};
    const cursor1 = coll1.find(filter1);
    const result1 = await cursor1.toArray();
    console.log(msg.reply_to_message.text)
            const events = {events : [...result1[0].events.filter((arr) => arr.id !== msg.reply_to_message.text)]}
            console.log(events)
            await coll1.updateOne(
                {_id: new ObjectId(result1[0]._id)},
                {
                  $set: { ...events},
                  $currentDate: { lastModified: true }
                }
             )
            await client.close();
            lastUserMessage[msg.from.id] = "text–§–∞–π–ª";
    return await bot.sendMessage(msg.chat.id, '–ü–æ–¥—ñ—é –≤–∏–¥–∞–ª–µ–Ω–æ');
}else{
        return null;
    }
}else if(userStatus[msg.from.id] === 0){
return null;
}
});

bot.on('/start', async msg => {
    lastUserMessage[msg.from.id] = msg.text;
    let replyMarkup = bot.keyboard([
        ['–°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–ª–∞—Å'],
        ['–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –≤ –∫–ª–∞—Å, —è–∫ —É—á–µ–Ω—å', '–ü—Ä–∏—î–¥–Ω–∞—Ç–∏—Å—è –≤ –∫–ª–∞—Å, —è–∫ –≤—á–∏—Ç–µ–ª—å']
    ], {resize: true});

    return bot.sendMessage(msg.from.id, `ü§ñ –ü—Ä–∏–≤—ñ—Ç, ${msg.from.first_name}! –Ø –≤–∞—à –æ—Å–æ–±–∏—Å—Ç–∏–π –Ω–∞–≤—á–∞–ª—å–Ω–∏–π –∞—Å–∏—Å—Ç–µ–Ω—Ç! –ó –º–æ—î—é –¥–æ–ø–æ–º–æ–≥–æ—é –≤–∏ –∑–º–æ–∂–µ—Ç–µ –ª–µ–≥–∫–æ –∫–µ—Ä—É–≤–∞—Ç–∏ –Ω–∞–≤—á–∞–ª—å–Ω–∏–º –ø—Ä–æ—Ü–µ—Å–æ–º. –û—Å—å –¥–µ—è–∫—ñ –∑ —Ñ—É–Ω–∫—Ü—ñ–π, —è–∫—ñ —è –º–æ–∂—É –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏:
    
    üè´ –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –Ω–∞–≤—á–∞–ª—å–Ω–∏–º–∏ –≥—Ä—É–ø–∞–º–∏
    üìö –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∫–æ—Ä–∏—Å–Ω—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª–∏ –≤—ñ–¥ –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤
    üìå –í–∞–∂–ª–∏–≤—ñ –∫–æ–Ω—Ç–∞–∫—Ç–∏ —Ç–∞ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è
    üìã –ó–∞–≤–¥–∞–Ω–Ω—è –≤—ñ–¥ –≤–∏–∫–ª–∞–¥–∞—á—ñ–≤ —Ç–∞ —ó—Ö –∑–¥–∞—á–∞
    üìÅ –ü–µ—Ä–µ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ —É –≥—Ä—É–ø—ñ
    üìù –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ç–µ—Å—Ç—ñ–≤
    üóìÔ∏è –ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è –ø–æ–¥—ñ–π —Ç–∞ –∑—É—Å—Ç—Ä—ñ—á–µ–π
    üìä –û—Ü—ñ–Ω–∫–∏ —Ç–∞ –≤—ñ–¥–≤—ñ–¥—É–≤–∞–Ω—ñ—Å—Ç—å —É—Ä–æ–∫—ñ–≤
    üìö –ú–∞—Ç–µ—Ä—ñ–∞–ª–∏ –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–∞ –ø—ñ–¥—Å—É–º–∫–∏ —É—Ä–æ–∫—ñ–≤
    
    ...—Ç–∞ –±–∞–≥–∞—Ç–æ —ñ–Ω—à–æ–≥–æ! –ü—Ä–æ—Å—Ç–æ –≤–≤–µ–¥—ñ—Ç—å –∫–æ–º–∞–Ω–¥—É –∞–±–æ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –∫–Ω–æ–ø–∫—É, —â–æ–± —Ä–æ–∑–ø–æ—á–∞—Ç–∏. –Ø –≥–æ—Ç–æ–≤–∏–π –¥–æ–ø–æ–º–æ–≥—Ç–∏ –≤–∞–º —É –≤—Å—å–æ–º—É, –ø–æ–≤'—è–∑–∞–Ω–æ–º—É –∑ –Ω–∞–≤—á–∞–Ω–Ω—è–º. –ü–æ—á–Ω—ñ–º–æ —Ä–∞–∑–æ–º! üéì`, {replyMarkup});

});




// bot.on("text", async msg => {
//     let replyMarkup = bot.keyboard([
//         ['/buttons', '/inlineKeyboard'],
//         ['/start', '/hide']
//     ], {resize: true});

//     return bot.sendMessage(msg.from.id, 'Keyboard example.', {replyMarkup});
// });

// bot.on('/inlineKeyboard', msg => {

//     let replyMarkup = bot.inlineKeyboard([
//         [
//             bot.inlineButton('callback', {callback: 'this_is_data'}),
//             bot.inlineButton('inline', {inline: 'some query'})
//         ], [
//             bot.inlineButton('url', {url: 'https://telegram.org'})
//         ]
//     ]);

//     return bot.sendMessage(msg.from.id, 'Inline keyboard example.', {replyMarkup});

// });

// Inline button callback
bot.on('callbackQuery', msg => {
    // User message alert
    console.log(msg.data)
    if(userAction[msg.from.id] !== undefined && userAction[msg.from.id][userAction[msg.from.id].length-1].act){
        let newArr = userAction[msg.from.id].filter(arr => arr.joinId === msg.data);
        console.log(newArr)
        userStatus[msg.from.id] = newArr[0].role;
        userClass[msg.from.id] = newArr[0].id;
        userAction[msg.from.id]= undefined;
        if(userStatus[msg.from.id]){
            let replyMarkup = bot.keyboard([
                ["–ñ—É—Ä–Ω–∞–ª","–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞","–£—á–∞—Å–Ω–∏–∫–∏"],
                ["–†–æ–∑–∫–ª–∞–¥","–§–∞–π–ª–∏ —É—Ä–æ–∫—É", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —É—Ä–æ–∫—É"],
                ["–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏","C—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞—Ç–µ—Ä—ñ–∞–ª—É","–î/–∑", "–ó–∞–¥–∞—Ç–∏ –¥/–∑"],
                ["–§–∞–π–ª–∏", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª–∞","–ü–æ–¥—ñ—ó","–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–¥—ñ—ó"],
                ["–ù–∞–ø–∏—Å–∞—Ç–∏ —É—á–∞—Å–Ω–∏–∫—É","–ó—Ä–æ–±–∏—Ç–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è","–ö–ª–∞—Å–∏"]
            ], {resize: true});
            bot.sendMessage(msg.from.id,`–í–∏ —É—Å–ø—ñ—à–Ω–æ —É–≤—ñ–π—à–ª–∏ –≤ –∫—ñ–º–Ω–∞—Ç—É ${newArr[0].name}`,{replyMarkup})
        }else{
            let replyMarkup = bot.keyboard([
                ["–©–æ–¥–µ–Ω–∏–∫","–ü–æ–¥—ñ—ó","–£—á–∞—Å–Ω–∏–∫–∏"],
                ["–†–æ–∑–∫–ª–∞–¥","–§–∞–π–ª–∏ —É—Ä–æ–∫—É", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —É—Ä–æ–∫—É"],
                ["–§–∞–π–ª–∏", "–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª–∞","–î/–∑", "–ó–¥–∞—Ç–∏ –¥/–∑"],
                ["–ú–∞—Ç–µ—Ä—ñ–∞–ª–∏","C—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞—Ç–µ—Ä—ñ–∞–ª—É"],
                ["–ù–∞–ø–∏—Å–∞—Ç–∏ —É—á–∞—Å–Ω–∏–∫—É","–ö–ª–∞—Å–∏"]
            ], {resize: true});
            bot.sendMessage(msg.from.id,`–í–∏ —É—Å–ø—ñ—à–Ω–æ —É–≤—ñ–π—à–ª–∏ –≤ –∫—ñ–º–Ω–∞—Ç—É ${newArr[0].name}`,{replyMarkup})
        }

    }

    return bot.answerCallbackQuery(msg.from.id, `Inline button callback: ${ msg.data }`, true);
});

// // Inline query
// bot.on('inlineQuery', msg => {

//     const query = msg.query;
//     const answers = bot.answerList(msg.id);

//     answers.addArticle({
//         id: 'query',
//         title: 'Inline Query',
//         description: `Your query: ${ query }`,
//         message_text: 'Click!'
//     });

//     return bot.answerQuery(answers);

// });

export default bot

//YsbcVL8dXcW0lAY7


